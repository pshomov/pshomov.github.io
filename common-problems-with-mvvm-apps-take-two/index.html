<!doctype html>
<!--[if lt IE 7]>
    <html class="no-js lt-ie9 lt-ie8 lt-ie7">
    <![endif]-->
    <!--[if IE 7]>
        <html class="no-js lt-ie9 lt-ie8">
        <![endif]-->
        <!--[if IE 8]>
            <html class="no-js lt-ie9">
            <![endif]-->
            <!--[if gt IE 8]>
                <!-->
                <html class="no-js">
                <!--<![endif]-->
                <meta charset="utf-8">
                <meta http-equiv="X-UA-Compatible" content="IE=edge">
                <title></title>
                <meta name="description" content="This is Petar's blog about programming and design">
                <link rel="me" type="text/html" href="http://twitter.com/pshomov">                    
                <link rel='alternate' type='application/atom+xml' title='Atom feed' href='https://pshomov.github.io/atom.xml'>
                <link rel='alternate' type='application/rss+xml' title='RSS feed' href='https://pshomov.github.io/rss.xml'>
                <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
                <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

                <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

                <link rel="stylesheet" href="/styles/vendor.ebca39d7.css">

                <link rel="stylesheet" href="/styles/main.c23a7b7b.css">
                
                <script src="https://rawgit.com/natevw/fermata/master/fermata.js"></script>                
                <script src="/js/vendor.28bec23a.js"></script>
                
                </head>
                
                <body>
                    <!--[if lt IE 7]>
                        <p class="browsehappy">You are using an
                            <strong>outdated</strong>browser. Please
                            <a href="http://browsehappy.com/">upgrade
    your browser</a>to improve your experience.</p>
                    <![endif]-->
                    <!--[if lt IE 9]>
                        <script src="bower_components/es5-shim/es5-shim.js"></script>
                        <script src="bower_components/json3/lib/json3.min.js"></script>
                    <![endif]-->
                    <!-- Add your site or application content here -->
                    <div id="container">
                        <div class="aboutme my_name_is">
                            <div class="picture-of-me block_center"></div>
                            <h4 class="my_name_is">
                                <a href="/introduction">My name is Petar</a>
                            </h4>
                            <h6>This is where I write about the things I find interesting</h6>
                            <div class="hcenter">
                                <span>                                    
                                    <a href="http://github.com/pshomov"><i class="fa fa-github fa-3x badge"></i></a></a>
                                    <a href="http://twitter.com/pshomov"><i class="fa fa-twitter fa-3x badge"></i></a>
                                </span>
                            </div>
                        </div>
                        <div class="content">
  <h1 href="top">Common problems with MVVM apps - take two</h1>
  <time>2015-09-28</time>
  <p>My last post <a href="/common-problems-with-mvvm-apps/">Common problems with MVVM</a> was it seems pretty vague and needs a concrete example to make a bit more sense. Not to mention in an attempt to not sound too authoritative I managed to represent myself like someone who is just starting with MVVM and and is taking too big of a bite.</p>
<p>Let&#39;s dive right into a typical example of a login page view model from a Xamarin Forms app:</p>
<script src="https://gist.github.com/pshomov/eb03fc62e07b9497d12a.js"></script>

<p>In case you are wondering - I am using <a href="https://github.com/Fody/PropertyChanged">Fody.PropertyChanged</a> to skip the minutiae of property change notifications. </p>
<p>The problem in my opinion is in the Login command - lines 23-25. Upon triggering the Login command the view model invokes the authentication process and in the case of success, navigates to the &quot;main&quot; view.</p>
<ol>
<li>The view model should not know about the authentication process at all. Neither when nor how it should be accomplished. It&#39;s not important to the view and makes it harder to test it. Should we decide to handle failure to authenticate, the code in that login command will get more complicated real quick.  </li>
<li>The view model should not know anything about the navigation process. Again neither when nor how. Not relevant to the view. It makes it more difficult to experiment with the view or use it in a different way - for example for Sign Up.</li>
</ol>
<p>I think we would be better off with a view model more like this one:</p>
<script src="https://gist.github.com/pshomov/b297f5e661f88689cca4.js"></script>

<p>Yes, I made up a pubsub &quot;thing&quot; that allows for publishing and subscribing ;-).</p>
<p>Now this model is much simpler and rather easy to test. In fact it is so simple I think I just lost interest in testing it.
I would rather test the logic that controls it, and that is what I really wanted to get you curious about ;)</p>
<p>I will keep working on that new sample but meanwhile I encourage you to post your thoughts in the comments below.</p>
<p>Until next time.</p>

  
  <div class="comments-title" href="comments">Comments (<a href="/comments-powered-by-github/">powered by GitHub issues</a>):</div>    
  <div id="comments" class="comments">
    <div class="hcenter spinner">
    </div>
  </div>
  <div class="hcenter comments__post"><a class="button" href="https://github.com/pshomov/pshomov.github.io/issues/4">Post your comment&nbsp;<i class="fa fa-github"></i></a></div>
  <script>
    function formatCommentTimestamp(timestamp) {
      return timestamp.toLocaleString();
    }
    function loadComments(data) {
      var comments = "";
      for (var i=0; i<data.length; i++) {
        var cuser = data[i].user.login;
        var cuserlink = "https://www.github.com/" + data[i].user.login;
        var clink = "https://github.com/pshomov/pshomov.github.io/issues/4#issuecomment-" + data[i].url.substring(data[i].url.lastIndexOf("/")+1);
       var cbody = data[i].body;
       var cavatarlink = data[i].user.avatar_url;
       var cdate = formatCommentTimestamp(new Date(data[i].created_at));
    
       comments += "<div class='comment'>"+'<img src="' + cavatarlink + '" class="avatar">'+"<div class='comment__info'>"+"<div class='comment__header'><a class='comment__user' href=\""+ cuserlink + "\">" + cuser + "</a>" + "<a class='comment__date' href=\"" + clink + "\">" + cdate + "</a></div><div class='comment__body'>" + marked(cbody) + "</div></div></div>";
     }
     if (comments == ""){
       comments = '<div class="hcenter">No comments have been posted yet, wanna go first? <i class="fa fa-hand-o-down"></i></div>';
     }
     document.getElementById("comments").innerHTML = comments;
    }
    var site = fermata.json('https://api.github.com');
    
    site('repos','pshomov', 'pshomov.github.io','issues','4', 'comments').get(function (err, data, headers){
      if (err == null){
       loadComments(data); 
      }
    });
  </script>  
  
</div>
                        <!-- <div class="links">links</div> --></div>
                    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID -->
                    <script>
                        (function(i, s, o, g, r, a, m) {
                            i['GoogleAnalyticsObject'] = r;
                            i[r] = i[r] || function() {
                                (i[r].q = i[r].q || []).push(arguments)
                            }, i[r].l = 1 * new Date();
                            a = s.createElement(o),
                            m = s.getElementsByTagName(o)[0];
                            a.async = 1;
                            a.src = g;
                            m.parentNode.insertBefore(a, m)
                        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
                    
                        ga('create', 'UA-50877599-1', 'pshomov.github.io');
                        ga('send', 'pageview');
                    </script>
                </body>
                
                </html>